## ブラウザ検索を自動化

## 参考

https://learn.microsoft.com/ja-jp/power-automate/desktop-flows/automation-web

### 検索の手順

1. webブラウザを特定のサイトURLで開く
2. 検索窓に単語貼り付けor入力
3. 検索ボタン押下
4. 結果表示
5. 2サイト目以降も同様の検索をして結果表示

### フロー作成メモ

- PowerAutomateを更新したあとにブラウザを立ち上げると、拡張機能をONにしますかが自動的に表示された。
- UI要素の追加はCtrl+左クリック
- マイページからエラーで進まないと思ったらボタンの要素が違っていた。  
  文字を入力すると虫眼鏡がクリアボタンになっていた。
- 実際に入力してみると上記のエラーはUIピッカーで回避できた。
- 検索単語の設定は、フロー最初に「入力ダイアログの表示」を入れて入力するようにした。
- 2サイト目で検索するときに、「Webページに移動」だと1サイト目から直接移動してしまいダメだった。  
  「新しいタブを作成」だと1サイト目の結果ページを残したまま、2サイト目の結果を表示することができた。
- %Browser%：1サイト目、%NewBrowser%：2サイト目　なので、2サイト目のUI要素指定はNew~を指定する。
- 最後は「メッセージを表示」でフローが終わったこと表示するようにした。

### 実行環境

- Windows11

### 手動と自動の結果比較

(2サイトでの検索で比較)

| 手動/自動 | 時間 | メリット                 | デメリット                 |
| --------- | ---- | ------------------------ | -------------------------- |
| 手動      | 17秒 | 体感でも実際にも短時間   | 自分で操作しないといけない |
| 自動      | 20秒 | 動作中に他の作業ができる | PCの画面が操作できない     |

(感想)  
自動化動作中はPC画面が操作できない。途中でブラウザ画面を変えると変な結果になってしまった。  
自動化作動中はPC以外の作業をした方が良いかも。
